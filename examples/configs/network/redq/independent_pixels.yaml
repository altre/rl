in_keys: ["pixels"]
in_keys_policy_module: ["pixels"]
in_keys_qvalue: ["pixels", "action"]

activation_class: elu

mlp_net_kwargs:
  layer_class: ${exploration.network}
  activation_class: ${network.activation_class}
conv_net_kwargs:
  activation_class: ${network.activation_class}

policy_network:
  _target_: torchrl.modules.partial_probabilisticactor
  _partial_: True
  dist_param_keys: ${model.policy_out_keys}
  default_interaction_mode: ${model.default_interaction_mode}
  distribution_class: ${model.distribution_class}
  distribution_kwargs: ${model.distribution_kwargs}
  return_log_prob: True
  partial_tensordictmodule:
    _target_: torchrl.modules.partial_tensordictmodule
    _partial_: True
    in_keys: ${network.in_keys_policy_module}
    out_keys: ${model.policy_out_keys}
    wrapper: ${model.policy_net_wrapper}
    partial_module:
      _target_: torchrl.modules.DdpgCnnActor
      _partial_: True  # misses out_features
      use_avg_pooling: True
      mlp_net_kwargs: ${network.mlp_net_kwargs}
      conv_net_kwargs: ${network.conv_net_kwargs}

qvalue_network:
  _target_: torchrl.modules.ValueOperator
  in_keys: ${network.in_keys_qvalue}
  module:
    _target_: torchrl.modules.DdpgCnnQNet
    use_avg_pooling: True
    mlp_net_kwargs: ${network.mlp_net_kwargs}
    conv_net_kwargs: ${network.conv_net_kwargs}
